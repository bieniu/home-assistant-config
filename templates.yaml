- binary_sensor:
    - name: Pralka pralnia
      unique_id: pralka_pralnia
      icon: mdi:washing-machine
      state: "{{ states('sensor.power_washing_machine_pralnia') | int > 1 }}"
      availability: "{{ is_number(states('sensor.power_washing_machine_pralnia')) }}"

    - name: Zmywarka kuchnia
      unique_id: zmywarka_kuchnia
      icon: mdi:dishwasher
      state: "{{ states('sensor.power_dishwasher_kuchnia') | int > 1 }}"
      availability: "{{ is_number(states('sensor.power_dishwasher_kuchnia')) }}"

- trigger:
    - platform: state
      entity_id: weather.lowicz
  action:
    - service: weather.get_forecasts
      target:
        entity_id: weather.lowicz
      data:
        type: daily
      response_variable: daily_forecast
  sensor:
    - name: Pomocnik prognozy pogody
      unique_id: accuweather_forecast_daily_helper
      state: "{{ now().isoformat() }}"
      attributes:                                           
        forecast: "{{ daily_forecast['weather.lowicz'].forecast }}"
    - name: Dom Prawdopodobieństwo opadów
      unique_id: home_precipitation_probablility
      icon: mdi:weather-partly-rainy
      unit_of_measurement: "%"
      state_class: measurement
      state: "{{ daily_forecast['weather.lowicz'].forecast[0].precipitation_probability }}"

- trigger:
    - trigger: state
      entity_id: weather.lowicz
  action:
    - action: ai_task.generate_data
      data:
        entity_id: ai_task.google_ai_task
        task_name: Opis pogody
        instructions: >-
          Opisz jednym zdaniem warunki pogodowe na podstawie {{ states.weather.dom }} oraz
          {{ states.sensor.dom_prawdopodobienstwo_opadow }}. Nie podawaj wartości liczbowych,
          podaj informacje o zachmurzeniu (pamiętaj, że "partlycloudy" to częściowe zachmurzenie,
          a "mostlycloudy" to duże zachmurzenie), podaj informacje o wietrze (bezwietrzenie 0–2
          km/h, słaby wiatr 3–15 km/h, umiarkowany wiatr 16–30 km/h, silny wiatr 31–50 km/h,
          porywisty wiatr >50 km/h). Informacje o wilgotności podawaj tylko jeśli jest ona większa
          niż 70% i w tym samym czasie nie pada deszcz. Nie używaj określeń "ciepła pogoda" tylko
          "jest ciepło", nie używaj określeń "odczuwalna temperatura jest chłodna" tylko
          "oczuwalnie jest chłodno", nie używaj określeń "jest umiarkowanie" albo "temperatura
          jest łagodna" albo "wiatr jest bezwietrznie".
      response_variable: weather_description
  sensor:
    - name: Opis pogody
      unique_id: weather_description
      state: "{% if weather_description is defined %}{{ weather_description.data }}{% endif %}"
